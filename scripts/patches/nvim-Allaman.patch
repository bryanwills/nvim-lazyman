--- lua/core/settings.lua.orig	2023-06-05 18:26:45.635868085 -0700
+++ lua/core/settings.lua	2023-06-05 18:25:03.972025817 -0700
@@ -79,7 +79,7 @@
 -- Tools that should be installed by Mason
 M.tools = {
   -- Formatter
-  "black",
+  -- "black",
   "prettier",
   "stylua",
   "shfmt",
@@ -88,7 +88,7 @@
   "shellcheck",
   "tflint",
   "yamllint",
-  "ruff",
+  -- "ruff",
   -- DAP
   "debugpy",
   "codelldb",
--- lua/core/plugins/mason.lua.orig	2023-06-05 18:56:59.153237963 -0700
+++ lua/core/plugins/mason.lua	2023-06-05 18:59:38.646269035 -0700
@@ -11,12 +11,19 @@
 
     -- ensure tools (except LSPs) are installed
     local mr = require("mason-registry")
-    for _, tool in ipairs(settings.tools) do
-      local p = mr.get_package(tool)
-      if not p:is_installed() then
-        p:install()
+    local function install_ensured()
+      for _, tool in ipairs(settings.tools) do
+        local p = mr.get_package(tool)
+        if not p:is_installed() then
+          p:install()
+        end
       end
     end
+    if mr.refresh then
+      mr.refresh(install_ensured)
+    else
+      install_ensured()
+    end
 
     -- install LSPs
     require("mason-lspconfig").setup({ ensure_installed = settings.lsp_servers })
